/*! 2016.declantyson 2017-01-10 */
function cubeMovement(a,b){var c=$(window).height()/2,d=$(window).width()/4*3,e=65,f=65;b=c-b,b/=c,b=e*b,a=d-a,a/=d,a=f*a;var g=-a/100;g<0&&(g=-g),g=1.05+g;var h="rotate3d(1, 0, 0, "+b+"deg) rotate3d(0, 1, 0, "+a+"deg)",i=(a+90)/3,j=hsl2rgb(glob.hue,glob.sat,i);$("#cube .left").css({backgroundColor:"rgb("+j.r+","+j.g+","+j.b+")"}),i=(a-90)/3*-1,j=hsl2rgb(glob.hue,glob.sat,i),$("#cube .right").css({backgroundColor:"rgb("+j.r+","+j.g+","+j.b+")"}),i=(b-90)/3*-1,j=hsl2rgb(glob.hue,glob.sat,i),$("#cube .top").css({backgroundColor:"rgb("+j.r+","+j.g+","+j.b+")"}),i=(b+90)/3,j=hsl2rgb(glob.hue,glob.sat,i),$("#cube .bottom").css({backgroundColor:"rgb("+j.r+","+j.g+","+j.b+")"}),i=60-a/3,a<0&&(i=60+a/3),j=hsl2rgb(glob.hue,glob.sat,i),$("#cube .front").css({backgroundColor:"rgb("+j.r+","+j.g+","+j.b+")"}),$("#cube").css({transform:h})}function triggerPortfolio(a){$("html, body").animate({scrollTop:0},250),$(".view-portfolio-item").addClass("ready").height($("body").height());var b=$("<video loop/>"),c=$('<source type="video/mp4"/>');c.attr("src",a.find(".large-content").data("videosource")+".mp4");var d=$('<source type="video/webm"/>');d.attr("src",a.find(".large-content").data("videosource")+".webm");var e=$('<source type="video/ogg"/>');e.attr("src",a.find(".large-content").data("videosource")+".ogv"),b.append(c).append(d).append(e),$(".view-portfolio-item div").prepend(b),$(".view-portfolio-item div").append(a.find(".large-content").html()),$("video")[0].play(),window.location.hash=a.find(".large-content").data("hash"),$(window).width()<540&&$("video").attr("controls",!0)}function changePage(a){url="/themes/2016.declantyson/page.aspx?page="+a,$(".content").css({opacity:0}),pjaxit.changePage(url,250,function(){$(".content").css({opacity:1}),history.pushState("","New URL: /"+a,a)},650,!1)}function filterBlogsToCategory(a,b,c){glob.pageswitch=!0,$(".sidebar .listings .listing").each(function(){var b=$(this).clone();$(".new-listings").append(b),b.data("category")==a?b.addClass("visible"):b.removeClass("visible")}),$(".listings").removeClass("static"),c<b?($(".new-listings").addClass("after"),$(".listings").addClass("before")):($(".new-listings").addClass("before"),$(".listings").addClass("after")),setTimeout(function(){$(".new-listings").addClass("moving"),setTimeout(function(){$(".new-listings").removeClass("moving").addClass("static").removeClass("after").removeClass("before"),$(".listings").html($(".new-listings").html()).addClass("static").removeClass("after").removeClass("before"),$(".listings").append('<div class="clearfix"></div>'),$(".new-listings").html("").removeClass("static"),glob.pageswitch=!1},900)},20)}function hsl2rgb(a,b,c){var d,e,f,g,h,i;return b/=100,c/=100,0===b?g=h=i=255*c:(e=c<=.5?c*(b+1):c+b-c*b,d=2*c-e,f=a/360,g=Math.round(HueToRgb(d,e,f+1/3)),h=Math.round(HueToRgb(d,e,f)),i=Math.round(HueToRgb(d,e,f-1/3))),{r:g,g:h,b:i}}function HueToRgb(a,b,c){var d;return c<0?c+=1:c>1&&(c-=1),d=6*c<1?a+(b-a)*c*6:2*c<1?b:3*c<2?a+(b-a)*(2/3-c)*6:a,d=255*d}function isExternal(a){var b=a.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/);return"string"==typeof b[1]&&b[1].length>0&&b[1].toLowerCase()!==location.protocol||"string"==typeof b[2]&&b[2].length>0&&b[2].replace(new RegExp(":("+{"http:":80,"https:":443}[location.protocol]+")?$"),"")!==location.host}glob={page:"",hue:219,sat:10,introReady:!1},pjaxit.dynamicElementId="dynamic-content";var blogs={};$(document).ready(function(){if(!glob.processing){var a=window.location.pathname.split("/")[1];"admin"!==window.location.pathname.split("/")[1]&&(""===window.location.pathname.split("/")[1]&&(a="home"),$.ajax({url:"/json/",type:"GET"}).done(function(a){var b=a[0],c=b.date.split("/"),d=new Date(c[1],c[0],c[2]),e=!1;localStorage.previousUser?parseInt(localStorage.previousUserDate)<d.getTime()&&($(".latest-entry p").text("Welcome back! There's been an update since your last visit."),e=!0):(console.log("first time user!"),localStorage.previousUser=!0,$(".latest-entry p").text("Welcome to declantyson.net! Here is the latest blog entry so you can get a feel for what kind of person I am."),e=!0),e&&($(".latest-entry a").attr("href","/"+b.slug),$(".latest-entry img").attr("src",b.image),$(".latest-entry h3").html(b.title),$(".latest-entry h4").html(b.date.split(" ")[0]),$(".latest-entry").show(),setTimeout(function(){$(".latest-entry .revealer").addClass("in"),setTimeout(function(){$(".latest-entry .entry-container").addClass("visible"),$(".latest-entry .revealer").removeClass("in").addClass("out"),glob.slideLatestOut=setTimeout(function(){$(".latest-entry .revealer").removeClass("out").addClass("in"),setTimeout(function(){$(".latest-entry .entry-container").removeClass("visible"),$(".latest-entry .revealer").addClass("out"),setTimeout(function(){$(".latest-entry").remove()},400)},400)},5e3)},400)},1e3));var f=new Date;localStorage.previousUserDate=f.getTime();for(var g in a){var h=a[g];"undefined"==typeof blogs[h.category]&&(blogs[h.category]=[]),blogs[h.category].push(h);var i=$('<div class="listing"/>');i.attr("data-slug",h.slug).attr("data-category",h.category);var j=$("<img/>").attr("src","/assets/featured-images/"+h.slug+".jpg"),k=$("<h3/>").html(h.title),l=$('<div class="clear"/>'),m=$("<span/>").text(h.date.split(" ")[0]);i.append(j),i.append(k),k.append(m),i.append(l),$(".sidebar .listings").append(i)}filterBlogsToCategory("Tech and Design",-1),$(".sidebar .listings").length>0&&$(".sidebar .listings").mCustomScrollbar()}),glob.processing=!0,glob.pageswitch=!1,glob.page=a,"home"!==a&&changePage(a),$(".sidebar li").click(function(){$(this).index()==$(".sizer").attr("data-current")||glob.pageswitch||("Awards"==$(this).data("category"),filterBlogsToCategory($(this).data("category"),$(this).index(),$(".sizer").attr("data-current")),$(".sizer").attr("class","sizer item-"+$(this).index()).attr("data-current",$(this).index()))}),$("body").on("mousemove",function(a){cubeMovement(a.clientX,a.clientY)}),$("body").on("click",".blog-icon",function(a){$("body").toggleClass("sidebar-open")}),$("body").on("contextmenu","video",function(a){}),$("body").on("click",".listings .listing",function(a){var b=$(a.target);b.hasClass(".listing")||(b=b.closest(".listing")),$("body").removeClass("sidebar-open"),changePage(b.data("slug"))}),$("body").on("click",".latest-entry a",function(a){var b=$(a.target);clearTimeout(glob.slideLatestOut),$(".latest-entry .revealer").removeClass("out").addClass("in"),setTimeout(function(){$(".latest-entry .entry-container").removeClass("visible"),$(".latest-entry .revealer").addClass("out"),setTimeout(function(){$(".latest-entry").remove()},400)},400),changePage(b.attr("href"))}),$("body").on("click",".portfolio .col",function(a){var b=$(a.target);b.hasClass(".col")||(b=b.closest(".col")),$("html, body").animate({scrollTop:0},250),triggerPortfolio(b)}),$("body").on("click",".view-portfolio-item span",function(a){$(".view-portfolio-item").removeClass("ready"),$(".view-portfolio-item div").html(""),window.location.hash=""}),$("body").on("click",".view-portfolio-item",function(a){var b=$(a.target);b.hasClass("view-portfolio-item")&&($(".view-portfolio-item").removeClass("ready"),$(".view-portfolio-item div").html(""),window.location.hash="")}),$("body").on("keydown",function(a){27===a.keyCode&&($(".view-portfolio-item").removeClass("ready"),$(".view-portfolio-item div").html(""),window.location.hash="")}))}}),$(window).resize(function(){$(window).width()>590?$(".content, .newcontent, .oldcontent").width($(".main").width()):$(".content, .newcontent, .oldcontent").width($(".main").width()),$(".view-portfolio-item").height($("body").height()),$(".newcontent").css({top:$(window).height()}),$(".hovercircle").height($(".hovercircle").width());$(".bg-img").width(),$(window).width();setTimeout(function(){$("#grid").isotope()},500)}),$(window).scroll(function(){if($(".content .bg-img-holder img").height()>0){var a=$(".content .bg-img-holder img").height();a>600&&(a=600),$(".bg-img-holder").css({height:a-$(window).scrollTop()/2})}}),window.ondevicemotion=function(a){var b=$(window).height()/4,c=$(window).width()/4*3,d=Math.round(30*a.accelerationIncludingGravity.x),e=Math.round(30*a.accelerationIncludingGravity.y);cubeMovement(d+c,e+b)};